{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\KomPhone\\\\Desktop\\\\Parfumvilag2.0\\\\Parfumvilag_2.0\\\\frontend\\\\src\\\\pages\\\\Profile.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback, useContext } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { getUser, updateUser } from \"../services/userService\";\nimport { AuthContext } from \"../App\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Profile = () => {\n  _s();\n  // State from Context\n  const {\n    isLoggedIn,\n    user: contextUser,\n    login: contextLogin,\n    logout: contextLogout\n  } = useContext(AuthContext);\n\n  // Local State\n  const [user, setUser] = useState(contextUser || null); // Initialize from context\n  const [loading, setLoading] = useState(!contextUser); // Initial loading\n  const [updateLoading, setUpdateLoading] = useState(false); // Update operation loading\n  const [editing, setEditing] = useState(false);\n  const [error, setError] = useState(\"\"); // General errors or fetch errors\n  const [updateError, setUpdateError] = useState(\"\"); // Specific update errors\n  const [validationErrors, setValidationErrors] = useState({});\n  const [updateSuccess, setUpdateSuccess] = useState(\"\");\n\n  // Form state - Initialized in useEffect/initializeForm\n  const [newName, setNewName] = useState(\"\");\n  const [newEmail, setNewEmail] = useState(\"\");\n  const [newPassword, setNewPassword] = useState(\"\");\n  const [phoneNumber, setPhoneNumber] = useState(\"\");\n  const [imageUrl, setImageUrl] = useState(\"\");\n  const [profileImage, setProfileImage] = useState(\"\"); // State specifically for the displayed image URL\n\n  const navigate = useNavigate();\n\n  // --- Function to Initialize Form State from User Data ---\n  const initializeForm = useCallback(userData => {\n    if (!userData) return;\n    console.log(\"[initializeForm] Initializing form with:\", userData);\n    setNewName(userData.name || \"\");\n    setNewEmail(userData.email || \"\");\n    setPhoneNumber(userData.phone || \"\");\n    const currentImageUrl = userData.profile_picture_url || \"\";\n    setImageUrl(currentImageUrl); // Sync input field state\n    setProfileImage(currentImageUrl); // Sync display image state\n    setNewPassword(\"\");\n    setValidationErrors({});\n    // Keep existing general errors (setError), clear update specific ones\n    setUpdateError(\"\");\n    setUpdateSuccess(\"\");\n  }, []);\n\n  // --- Fetch User Data ---\n  const fetchUser = useCallback(async (force = false) => {\n    if (!isLoggedIn) {\n      navigate(\"/bejelentkezes\");\n      return null;\n    }\n    // Skip fetch if already loading, or if data exists and not forced\n    if (loading || !force && user) {\n      if (user && !editing) initializeForm(user); // Initialize form if displaying current data\n      return user;\n    }\n    console.log(\"[fetchUser] Fetching user data... Force fetch:\", force);\n    setLoading(true); // Use initial loading state\n    setError(\"\");\n    try {\n      const userData = await getUser();\n      console.log(\"[fetchUser] User data fetched:\", userData);\n      if (!userData) throw new Error(\"Nem érkeztek felhasználói adatok.\");\n\n      // Update local state AND context\n      setUser(userData);\n      contextLogin(userData, localStorage.getItem(\"token\"));\n\n      // Initialize form fields ONLY AFTER data is confirmed\n      initializeForm(userData);\n      setLoading(false); // Stop initial loading\n      return userData;\n    } catch (err) {\n      var _err$response;\n      console.error(\"[fetchUser] Profile fetch error:\", err);\n      setError(err.message || \"Hiba történt a profil betöltése közben.\");\n      setUser(null); // Clear user on error\n      if (err.message.includes(\"hitelesít\") || ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.status) === 401) {\n        console.log(\"[fetchUser] Auth error, logging out.\");\n        contextLogout();\n        navigate(\"/bejelentkezes\");\n      }\n      setLoading(false); // Stop initial loading on error\n      return null;\n    }\n  }, [isLoggedIn, navigate, contextLogin, contextLogout, user, loading, editing, initializeForm]); // Add editing dependency\n\n  // --- Effect to Fetch User Data on Mount/Login Change ---\n  useEffect(() => {\n    if (isLoggedIn) {\n      console.log(\"Effect: Logged in. ContextUser:\", contextUser, \"Local user:\", user);\n      // Fetch if local user state is null (e.g., after refresh)\n      // or if contextUser exists but local user is somehow out of sync (less likely now)\n      if (!user) {\n        fetchUser();\n      } else {\n        // If user exists (likely from context), ensure form is initialized\n        initializeForm(user);\n        if (loading) setLoading(false); // Correct loading state if initialized from context\n      }\n    } else {\n      // If logged out, clear local state and potentially redirect\n      console.log(\"Effect: Not logged in.\");\n      setUser(null);\n      // Optional: Redirect if needed, though usually handled by protected routes\n      // navigate('/bejelentkezes');\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isLoggedIn, contextUser]); // Re-run when login status or context user changes\n\n  // --- Form Validation ---\n  const validateForm = useCallback(() => {\n    const errors = {};\n    if (!newName.trim()) errors.name = \"Név megadása kötelező!\";\n    if (!newEmail.trim()) {\n      errors.email = \"Email cím megadása kötelező!\";\n    } else if (!/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(newEmail)) {\n      errors.email = \"Érvénytelen email cím formátum!\";\n    }\n    if (newPassword && newPassword.length < 6) {\n      errors.password = \"A jelszónak legalább 6 karakter hosszúnak kell lennie!\";\n    }\n    if (phoneNumber && phoneNumber.trim() && !/^\\+?[0-9\\s-()]{7,}$/.test(phoneNumber)) {\n      errors.phoneNumber = \"Érvénytelen telefonszám formátum!\";\n    }\n    const trimmedImageUrl = imageUrl.trim();\n    if (trimmedImageUrl && !/^https?:\\/\\/.+\\..+/i.test(trimmedImageUrl)) {\n      errors.imageUrl = \"Érvénytelen URL formátum! (http:// vagy https:// kell)\";\n    }\n    setValidationErrors(errors);\n    return Object.keys(errors).length === 0;\n  }, [newName, newEmail, newPassword, phoneNumber, imageUrl]);\n\n  // --- Handle Update ---\n  const handleEdit = async e => {\n    e.preventDefault();\n    if (!validateForm()) return;\n    setUpdateLoading(true); // START update loading\n    setUpdateError(\"\"); // Clear previous update errors\n    setUpdateSuccess(\"\");\n    const updatedData = {\n      name: newName.trim(),\n      email: newEmail.trim(),\n      phone: phoneNumber.trim() || null,\n      profile_picture_url: imageUrl.trim() || null\n    };\n    if (newPassword.trim()) {\n      updatedData.password = newPassword.trim();\n    }\n    try {\n      console.log(\"[handleEdit] Attempting update with data:\", updatedData);\n      await updateUser(updatedData); // Call update service\n      console.log(\"[handleEdit] Update API call successful.\");\n\n      // --- Force Re-fetch after successful update ---\n      console.log(\"[handleEdit] Re-fetching user data after update...\");\n      const freshUserData = await fetchUser(true); // Force fetch = true\n\n      if (freshUserData) {\n        console.log(\"[handleEdit] Re-fetch successful, update complete.\");\n        setEditing(false); // Exit editing mode AFTER successful re-fetch and state update\n        setUpdateSuccess(\"Adatok sikeresen frissítve!\");\n        setTimeout(() => setUpdateSuccess(\"\"), 4000);\n        // Form is already initialized by fetchUser -> initializeForm\n      } else {\n        // This means fetchUser failed after a successful PUT\n        console.error(\"[handleEdit] CRITICAL: Update succeeded but re-fetch failed!\");\n        setUpdateError(\"Adatok mentve, de a profil frissítése a felületen sikertelen. Próbáld meg frissíteni az oldalt.\");\n        // Keep editing mode open? Or close? User choice. Let's close.\n        setEditing(false);\n      }\n    } catch (updateErr) {\n      // Catch errors specifically from updateUser OR fetchUser\n      console.error(\"[handleEdit] Profile update process error:\", updateErr);\n      setUpdateError(updateErr.message || \"Hiba történt az adatok mentése közben.\");\n    } finally {\n      // --- Ensure update loading stops ---\n      console.log(\"[handleEdit] Update process finished.\");\n      setUpdateLoading(false); // STOP update loading indicator\n    }\n  };\n\n  // --- Logout ---\n  const handleLogout = () => {\n    if (window.confirm(\"Biztosan ki szeretne lépni?\")) {\n      contextLogout();\n      navigate(\"/\");\n    }\n  };\n\n  // --- Cancel Edit ---\n  const handleCancelEdit = () => {\n    setEditing(false);\n    if (user) {\n      // Reset form from current user state\n      initializeForm(user);\n    }\n    // Clear errors relevant to editing\n    setUpdateError(\"\");\n    setValidationErrors({});\n    setUpdateSuccess(\"\");\n  };\n\n  // --- Render Logic ---\n\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container text-center p-5\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"spinner-border text-primary\",\n        role: \"status\",\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"visually-hidden\",\n          children: \"Profil bet\\xF6lt\\xE9se...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 7\n    }, this);\n  }\n  if (!user) {\n    // Render error/login prompt if user is null after loading\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container py-5\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"alert alert-danger\",\n        role: \"alert\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Hiba\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: error || \"Felhasználói adatok nem tölthetők be. Kérjük, jelentkezzen be újra.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-primary me-2\",\n          onClick: () => navigate(\"/bejelentkezes\"),\n          children: \"Bejelentkez\\xE9s\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 11\n        }, this), !(error !== null && error !== void 0 && error.includes(\"hitelesít\")) &&\n        /*#__PURE__*/\n        // Show retry only if not an auth error\n        _jsxDEV(\"button\", {\n          className: \"btn btn-outline-secondary\",\n          onClick: () => fetchUser(true),\n          children: \"\\xDAjrapr\\xF3b\\xE1l\\xE1s\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 7\n    }, this);\n  }\n\n  // --- Main Profile Render (User object is available) ---\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container py-5\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profile-card\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"profile-title mb-4\",\n        children: \"Profil\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 9\n      }, this), updateSuccess && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"alert alert-success\",\n        children: updateSuccess\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 11\n      }, this), updateError && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"alert alert-danger\",\n        children: updateError\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"profile-content\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"profile-image-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            // Use profileImage state for display (synced with user data)\n            src: profileImage || \"https://via.placeholder.com/150?text=Profil\",\n            alt: `${user.name} profilképe`,\n            className: \"profile-image\",\n            onError: e => {\n              e.target.onerror = null;\n              e.target.src = \"https://via.placeholder.com/150?text=Hiba\";\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 13\n          }, this), editing && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"profileImageUrl\",\n              className: \"form-label\",\n              children: \"Profilk\\xE9p URL\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 313,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              className: `form-control ${validationErrors.imageUrl ? \"is-invalid\" : \"\"}`,\n              id: \"profileImageUrl\",\n              value: imageUrl // Controlled by state\n              ,\n              onChange: e => {\n                const url = e.target.value;\n                setImageUrl(url); // Update input state\n                setProfileImage(url); // Update preview state\n              },\n              placeholder: \"K\\xE9p URL-je (pl. https://...)\",\n              \"aria-describedby\": \"imageUrlError\",\n              disabled: updateLoading\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 17\n            }, this), validationErrors.imageUrl && /*#__PURE__*/_jsxDEV(\"div\", {\n              id: \"imageUrlError\",\n              className: \"invalid-feedback\",\n              children: validationErrors.imageUrl\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 333,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"profile-subtitle mb-3\",\n          children: \"Felhaszn\\xE1l\\xF3i adatok\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 11\n        }, this), !editing ?\n        /*#__PURE__*/\n        // --- Display Mode ---\n        _jsxDEV(\"div\", {\n          className: \"profile-details\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"N\\xE9v:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 348,\n              columnNumber: 17\n            }, this), \" \", user.name]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 347,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Email:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 351,\n              columnNumber: 17\n            }, this), \" \", user.email]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Telefonsz\\xE1m:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 354,\n              columnNumber: 17\n            }, this), \" \", user.phone || \"Nincs megadva\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 353,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Regisztr\\xE1ci\\xF3:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 357,\n              columnNumber: 17\n            }, this), \" \", user.created_at ? new Date(user.created_at).toLocaleDateString(\"hu-HU\") : \"Ismeretlen\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 356,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile-actions mt-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-outline-primary\",\n              onClick: () => setEditing(true),\n              disabled: updateLoading,\n              children: \"Adatok szerkeszt\\xE9se\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 363,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-outline-danger ms-2\",\n              onClick: handleLogout,\n              disabled: updateLoading,\n              children: \"Kil\\xE9p\\xE9s\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 370,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 362,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 345,\n          columnNumber: 13\n        }, this) :\n        /*#__PURE__*/\n        // --- Editing Mode ---\n        _jsxDEV(\"form\", {\n          id: \"profileForm\",\n          onSubmit: handleEdit,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mb-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"editName\",\n              className: \"form-label\",\n              children: \"N\\xE9v\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 385,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              className: `form-control ${validationErrors.name ? \"is-invalid\" : \"\"}`,\n              id: \"editName\",\n              value: newName,\n              onChange: e => setNewName(e.target.value),\n              required: true,\n              disabled: updateLoading,\n              \"aria-describedby\": \"nameError\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 388,\n              columnNumber: 17\n            }, this), validationErrors.name && /*#__PURE__*/_jsxDEV(\"div\", {\n              id: \"nameError\",\n              className: \"invalid-feedback\",\n              children: validationErrors.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 401,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 384,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mb-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"editEmail\",\n              className: \"form-label\",\n              children: \"Email c\\xEDm\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 408,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"email\",\n              className: `form-control ${validationErrors.email ? \"is-invalid\" : \"\"}`,\n              id: \"editEmail\",\n              value: newEmail,\n              onChange: e => setNewEmail(e.target.value),\n              required: true,\n              disabled: updateLoading,\n              \"aria-describedby\": \"emailError\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 411,\n              columnNumber: 17\n            }, this), validationErrors.email && /*#__PURE__*/_jsxDEV(\"div\", {\n              id: \"emailError\",\n              className: \"invalid-feedback\",\n              children: validationErrors.email\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 424,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 407,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mb-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"editPhoneNumber\",\n              className: \"form-label\",\n              children: \"Telefonsz\\xE1m (opcion\\xE1lis)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 431,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"tel\",\n              className: `form-control ${validationErrors.phoneNumber ? \"is-invalid\" : \"\"}`,\n              id: \"editPhoneNumber\",\n              value: phoneNumber,\n              onChange: e => setPhoneNumber(e.target.value),\n              placeholder: \"Pl. +36 30 123 4567\",\n              disabled: updateLoading,\n              \"aria-describedby\": \"phoneNumberError\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 434,\n              columnNumber: 17\n            }, this), validationErrors.phoneNumber && /*#__PURE__*/_jsxDEV(\"div\", {\n              id: \"phoneNumberError\",\n              className: \"invalid-feedback\",\n              children: validationErrors.phoneNumber\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 447,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 430,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mb-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"editPassword\",\n              className: \"form-label\",\n              children: \"\\xDAj jelsz\\xF3 (\\xFCresen hagyva nem v\\xE1ltozik)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 454,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"password\",\n              className: `form-control ${validationErrors.password ? \"is-invalid\" : \"\"}`,\n              id: \"editPassword\",\n              value: newPassword,\n              onChange: e => setNewPassword(e.target.value),\n              placeholder: \"Min. 6 karakter\",\n              disabled: updateLoading,\n              \"aria-describedby\": \"passwordError\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 457,\n              columnNumber: 17\n            }, this), validationErrors.password && /*#__PURE__*/_jsxDEV(\"div\", {\n              id: \"passwordError\",\n              className: \"invalid-feedback\",\n              children: validationErrors.password\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 470,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 453,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile-actions mt-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              className: \"btn btn-primary\",\n              disabled: updateLoading,\n              children: updateLoading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"spinner-border spinner-border-sm me-2\",\n                  role: \"status\",\n                  \"aria-hidden\": \"true\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 484,\n                  columnNumber: 23\n                }, this), \"Ment\\xE9s...\"]\n              }, void 0, true) : \"Mentés\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 477,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"btn btn-outline-secondary ms-2\",\n              onClick: handleCancelEdit,\n              disabled: updateLoading,\n              children: \"M\\xE9gse\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 495,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 476,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 286,\n    columnNumber: 5\n  }, this);\n};\n_s(Profile, \"Q3zBaSeGHmbEamE9X92Smf0mdoU=\", false, function () {\n  return [useNavigate];\n});\n_c = Profile;\nexport default Profile;\nvar _c;\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useContext","useNavigate","getUser","updateUser","AuthContext","jsxDEV","_jsxDEV","Fragment","_Fragment","Profile","_s","isLoggedIn","user","contextUser","login","contextLogin","logout","contextLogout","setUser","loading","setLoading","updateLoading","setUpdateLoading","editing","setEditing","error","setError","updateError","setUpdateError","validationErrors","setValidationErrors","updateSuccess","setUpdateSuccess","newName","setNewName","newEmail","setNewEmail","newPassword","setNewPassword","phoneNumber","setPhoneNumber","imageUrl","setImageUrl","profileImage","setProfileImage","navigate","initializeForm","userData","console","log","name","email","phone","currentImageUrl","profile_picture_url","fetchUser","force","Error","localStorage","getItem","err","_err$response","message","includes","response","status","validateForm","errors","trim","test","length","password","trimmedImageUrl","Object","keys","handleEdit","e","preventDefault","updatedData","freshUserData","setTimeout","updateErr","handleLogout","window","confirm","handleCancelEdit","className","children","role","fileName","_jsxFileName","lineNumber","columnNumber","onClick","src","alt","onError","target","onerror","htmlFor","type","id","value","onChange","url","placeholder","disabled","created_at","Date","toLocaleDateString","onSubmit","required","_c","$RefreshReg$"],"sources":["C:/Users/KomPhone/Desktop/Parfumvilag2.0/Parfumvilag_2.0/frontend/src/pages/Profile.js"],"sourcesContent":["import React, { useState, useEffect, useCallback, useContext } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { getUser, updateUser } from \"../services/userService\";\r\nimport { AuthContext } from \"../App\";\r\n\r\nconst Profile = () => {\r\n  // State from Context\r\n  const {\r\n    isLoggedIn,\r\n    user: contextUser,\r\n    login: contextLogin,\r\n    logout: contextLogout,\r\n  } = useContext(AuthContext);\r\n\r\n  // Local State\r\n  const [user, setUser] = useState(contextUser || null); // Initialize from context\r\n  const [loading, setLoading] = useState(!contextUser); // Initial loading\r\n  const [updateLoading, setUpdateLoading] = useState(false); // Update operation loading\r\n  const [editing, setEditing] = useState(false);\r\n  const [error, setError] = useState(\"\"); // General errors or fetch errors\r\n  const [updateError, setUpdateError] = useState(\"\"); // Specific update errors\r\n  const [validationErrors, setValidationErrors] = useState({});\r\n  const [updateSuccess, setUpdateSuccess] = useState(\"\");\r\n\r\n  // Form state - Initialized in useEffect/initializeForm\r\n  const [newName, setNewName] = useState(\"\");\r\n  const [newEmail, setNewEmail] = useState(\"\");\r\n  const [newPassword, setNewPassword] = useState(\"\");\r\n  const [phoneNumber, setPhoneNumber] = useState(\"\");\r\n  const [imageUrl, setImageUrl] = useState(\"\");\r\n  const [profileImage, setProfileImage] = useState(\"\"); // State specifically for the displayed image URL\r\n\r\n  const navigate = useNavigate();\r\n\r\n  // --- Function to Initialize Form State from User Data ---\r\n  const initializeForm = useCallback((userData) => {\r\n    if (!userData) return;\r\n    console.log(\"[initializeForm] Initializing form with:\", userData);\r\n    setNewName(userData.name || \"\");\r\n    setNewEmail(userData.email || \"\");\r\n    setPhoneNumber(userData.phone || \"\");\r\n    const currentImageUrl = userData.profile_picture_url || \"\";\r\n    setImageUrl(currentImageUrl); // Sync input field state\r\n    setProfileImage(currentImageUrl); // Sync display image state\r\n    setNewPassword(\"\");\r\n    setValidationErrors({});\r\n    // Keep existing general errors (setError), clear update specific ones\r\n    setUpdateError(\"\");\r\n    setUpdateSuccess(\"\");\r\n  }, []);\r\n\r\n  // --- Fetch User Data ---\r\n  const fetchUser = useCallback(\r\n    async (force = false) => {\r\n      if (!isLoggedIn) {\r\n        navigate(\"/bejelentkezes\");\r\n        return null;\r\n      }\r\n      // Skip fetch if already loading, or if data exists and not forced\r\n      if (loading || (!force && user)) {\r\n        if (user && !editing) initializeForm(user); // Initialize form if displaying current data\r\n        return user;\r\n      }\r\n\r\n      console.log(\"[fetchUser] Fetching user data... Force fetch:\", force);\r\n      setLoading(true); // Use initial loading state\r\n      setError(\"\");\r\n      try {\r\n        const userData = await getUser();\r\n        console.log(\"[fetchUser] User data fetched:\", userData);\r\n        if (!userData) throw new Error(\"Nem érkeztek felhasználói adatok.\");\r\n\r\n        // Update local state AND context\r\n        setUser(userData);\r\n        contextLogin(userData, localStorage.getItem(\"token\"));\r\n\r\n        // Initialize form fields ONLY AFTER data is confirmed\r\n        initializeForm(userData);\r\n\r\n        setLoading(false); // Stop initial loading\r\n        return userData;\r\n      } catch (err) {\r\n        console.error(\"[fetchUser] Profile fetch error:\", err);\r\n        setError(err.message || \"Hiba történt a profil betöltése közben.\");\r\n        setUser(null); // Clear user on error\r\n        if (err.message.includes(\"hitelesít\") || err.response?.status === 401) {\r\n          console.log(\"[fetchUser] Auth error, logging out.\");\r\n          contextLogout();\r\n          navigate(\"/bejelentkezes\");\r\n        }\r\n        setLoading(false); // Stop initial loading on error\r\n        return null;\r\n      }\r\n    },\r\n    [\r\n      isLoggedIn,\r\n      navigate,\r\n      contextLogin,\r\n      contextLogout,\r\n      user,\r\n      loading,\r\n      editing,\r\n      initializeForm,\r\n    ]\r\n  ); // Add editing dependency\r\n\r\n  // --- Effect to Fetch User Data on Mount/Login Change ---\r\n  useEffect(() => {\r\n    if (isLoggedIn) {\r\n      console.log(\r\n        \"Effect: Logged in. ContextUser:\",\r\n        contextUser,\r\n        \"Local user:\",\r\n        user\r\n      );\r\n      // Fetch if local user state is null (e.g., after refresh)\r\n      // or if contextUser exists but local user is somehow out of sync (less likely now)\r\n      if (!user) {\r\n        fetchUser();\r\n      } else {\r\n        // If user exists (likely from context), ensure form is initialized\r\n        initializeForm(user);\r\n        if (loading) setLoading(false); // Correct loading state if initialized from context\r\n      }\r\n    } else {\r\n      // If logged out, clear local state and potentially redirect\r\n      console.log(\"Effect: Not logged in.\");\r\n      setUser(null);\r\n      // Optional: Redirect if needed, though usually handled by protected routes\r\n      // navigate('/bejelentkezes');\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [isLoggedIn, contextUser]); // Re-run when login status or context user changes\r\n\r\n  // --- Form Validation ---\r\n  const validateForm = useCallback(() => {\r\n    const errors = {};\r\n    if (!newName.trim()) errors.name = \"Név megadása kötelező!\";\r\n    if (!newEmail.trim()) {\r\n      errors.email = \"Email cím megadása kötelező!\";\r\n    } else if (!/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(newEmail)) {\r\n      errors.email = \"Érvénytelen email cím formátum!\";\r\n    }\r\n    if (newPassword && newPassword.length < 6) {\r\n      errors.password =\r\n        \"A jelszónak legalább 6 karakter hosszúnak kell lennie!\";\r\n    }\r\n    if (\r\n      phoneNumber &&\r\n      phoneNumber.trim() &&\r\n      !/^\\+?[0-9\\s-()]{7,}$/.test(phoneNumber)\r\n    ) {\r\n      errors.phoneNumber = \"Érvénytelen telefonszám formátum!\";\r\n    }\r\n    const trimmedImageUrl = imageUrl.trim();\r\n    if (trimmedImageUrl && !/^https?:\\/\\/.+\\..+/i.test(trimmedImageUrl)) {\r\n      errors.imageUrl =\r\n        \"Érvénytelen URL formátum! (http:// vagy https:// kell)\";\r\n    }\r\n    setValidationErrors(errors);\r\n    return Object.keys(errors).length === 0;\r\n  }, [newName, newEmail, newPassword, phoneNumber, imageUrl]);\r\n\r\n  // --- Handle Update ---\r\n  const handleEdit = async (e) => {\r\n    e.preventDefault();\r\n    if (!validateForm()) return;\r\n\r\n    setUpdateLoading(true); // START update loading\r\n    setUpdateError(\"\"); // Clear previous update errors\r\n    setUpdateSuccess(\"\");\r\n\r\n    const updatedData = {\r\n      name: newName.trim(),\r\n      email: newEmail.trim(),\r\n      phone: phoneNumber.trim() || null,\r\n      profile_picture_url: imageUrl.trim() || null,\r\n    };\r\n    if (newPassword.trim()) {\r\n      updatedData.password = newPassword.trim();\r\n    }\r\n\r\n    try {\r\n      console.log(\"[handleEdit] Attempting update with data:\", updatedData);\r\n      await updateUser(updatedData); // Call update service\r\n      console.log(\"[handleEdit] Update API call successful.\");\r\n\r\n      // --- Force Re-fetch after successful update ---\r\n      console.log(\"[handleEdit] Re-fetching user data after update...\");\r\n      const freshUserData = await fetchUser(true); // Force fetch = true\r\n\r\n      if (freshUserData) {\r\n        console.log(\"[handleEdit] Re-fetch successful, update complete.\");\r\n        setEditing(false); // Exit editing mode AFTER successful re-fetch and state update\r\n        setUpdateSuccess(\"Adatok sikeresen frissítve!\");\r\n        setTimeout(() => setUpdateSuccess(\"\"), 4000);\r\n        // Form is already initialized by fetchUser -> initializeForm\r\n      } else {\r\n        // This means fetchUser failed after a successful PUT\r\n        console.error(\r\n          \"[handleEdit] CRITICAL: Update succeeded but re-fetch failed!\"\r\n        );\r\n        setUpdateError(\r\n          \"Adatok mentve, de a profil frissítése a felületen sikertelen. Próbáld meg frissíteni az oldalt.\"\r\n        );\r\n        // Keep editing mode open? Or close? User choice. Let's close.\r\n        setEditing(false);\r\n      }\r\n    } catch (updateErr) {\r\n      // Catch errors specifically from updateUser OR fetchUser\r\n      console.error(\"[handleEdit] Profile update process error:\", updateErr);\r\n      setUpdateError(\r\n        updateErr.message || \"Hiba történt az adatok mentése közben.\"\r\n      );\r\n    } finally {\r\n      // --- Ensure update loading stops ---\r\n      console.log(\"[handleEdit] Update process finished.\");\r\n      setUpdateLoading(false); // STOP update loading indicator\r\n    }\r\n  };\r\n\r\n  // --- Logout ---\r\n  const handleLogout = () => {\r\n    if (window.confirm(\"Biztosan ki szeretne lépni?\")) {\r\n      contextLogout();\r\n      navigate(\"/\");\r\n    }\r\n  };\r\n\r\n  // --- Cancel Edit ---\r\n  const handleCancelEdit = () => {\r\n    setEditing(false);\r\n    if (user) {\r\n      // Reset form from current user state\r\n      initializeForm(user);\r\n    }\r\n    // Clear errors relevant to editing\r\n    setUpdateError(\"\");\r\n    setValidationErrors({});\r\n    setUpdateSuccess(\"\");\r\n  };\r\n\r\n  // --- Render Logic ---\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"container text-center p-5\">\r\n        <div className=\"spinner-border text-primary\" role=\"status\">\r\n          <span className=\"visually-hidden\">Profil betöltése...</span>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!user) {\r\n    // Render error/login prompt if user is null after loading\r\n    return (\r\n      <div className=\"container py-5\">\r\n        <div className=\"alert alert-danger\" role=\"alert\">\r\n          <h4>Hiba</h4>\r\n          <p>\r\n            {error ||\r\n              \"Felhasználói adatok nem tölthetők be. Kérjük, jelentkezzen be újra.\"}\r\n          </p>\r\n          <button\r\n            className=\"btn btn-primary me-2\"\r\n            onClick={() => navigate(\"/bejelentkezes\")}\r\n          >\r\n            Bejelentkezés\r\n          </button>\r\n          {!error?.includes(\"hitelesít\") && ( // Show retry only if not an auth error\r\n            <button\r\n              className=\"btn btn-outline-secondary\"\r\n              onClick={() => fetchUser(true)}\r\n            >\r\n              Újrapróbálás\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // --- Main Profile Render (User object is available) ---\r\n  return (\r\n    <div className=\"container py-5\">\r\n      <div className=\"profile-card\">\r\n        <h1 className=\"profile-title mb-4\">Profil</h1>\r\n\r\n        {updateSuccess && (\r\n          <div className=\"alert alert-success\">{updateSuccess}</div>\r\n        )}\r\n        {/* Show update-specific error when editing */}\r\n        {updateError && <div className=\"alert alert-danger\">{updateError}</div>}\r\n\r\n        <div className=\"profile-content\">\r\n          {/* Image Section */}\r\n          <div className=\"profile-image-section\">\r\n            <img\r\n              // Use profileImage state for display (synced with user data)\r\n              src={\r\n                profileImage || \"https://via.placeholder.com/150?text=Profil\"\r\n              }\r\n              alt={`${user.name} profilképe`}\r\n              className=\"profile-image\"\r\n              onError={(e) => {\r\n                e.target.onerror = null;\r\n                e.target.src = \"https://via.placeholder.com/150?text=Hiba\";\r\n              }}\r\n            />\r\n            {editing && (\r\n              <div className=\"mt-3\">\r\n                <label htmlFor=\"profileImageUrl\" className=\"form-label\">\r\n                  Profilkép URL\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  className={`form-control ${\r\n                    validationErrors.imageUrl ? \"is-invalid\" : \"\"\r\n                  }`}\r\n                  id=\"profileImageUrl\"\r\n                  value={imageUrl} // Controlled by state\r\n                  onChange={(e) => {\r\n                    const url = e.target.value;\r\n                    setImageUrl(url); // Update input state\r\n                    setProfileImage(url); // Update preview state\r\n                  }}\r\n                  placeholder=\"Kép URL-je (pl. https://...)\"\r\n                  aria-describedby=\"imageUrlError\"\r\n                  disabled={updateLoading}\r\n                />\r\n                {validationErrors.imageUrl && (\r\n                  <div id=\"imageUrlError\" className=\"invalid-feedback\">\r\n                    {validationErrors.imageUrl}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Details / Form Section */}\r\n          <h3 className=\"profile-subtitle mb-3\">Felhasználói adatok</h3>\r\n          {!editing ? (\r\n            // --- Display Mode ---\r\n            <div className=\"profile-details\">\r\n              {/* Display data directly from the 'user' state object */}\r\n              <p>\r\n                <strong>Név:</strong> {user.name}\r\n              </p>\r\n              <p>\r\n                <strong>Email:</strong> {user.email}\r\n              </p>\r\n              <p>\r\n                <strong>Telefonszám:</strong> {user.phone || \"Nincs megadva\"}\r\n              </p>\r\n              <p>\r\n                <strong>Regisztráció:</strong>{\" \"}\r\n                {user.created_at\r\n                  ? new Date(user.created_at).toLocaleDateString(\"hu-HU\")\r\n                  : \"Ismeretlen\"}\r\n              </p>\r\n              <div className=\"profile-actions mt-4\">\r\n                <button\r\n                  className=\"btn btn-outline-primary\"\r\n                  onClick={() => setEditing(true)}\r\n                  disabled={updateLoading}\r\n                >\r\n                  Adatok szerkesztése\r\n                </button>\r\n                <button\r\n                  className=\"btn btn-outline-danger ms-2\"\r\n                  onClick={handleLogout}\r\n                  disabled={updateLoading}\r\n                >\r\n                  Kilépés\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            // --- Editing Mode ---\r\n            <form id=\"profileForm\" onSubmit={handleEdit}>\r\n              {/* Input fields using state: newName, newEmail, phoneNumber, imageUrl, newPassword */}\r\n              {/* Name */}\r\n              <div className=\"mb-3\">\r\n                <label htmlFor=\"editName\" className=\"form-label\">\r\n                  Név\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  className={`form-control ${\r\n                    validationErrors.name ? \"is-invalid\" : \"\"\r\n                  }`}\r\n                  id=\"editName\"\r\n                  value={newName}\r\n                  onChange={(e) => setNewName(e.target.value)}\r\n                  required\r\n                  disabled={updateLoading}\r\n                  aria-describedby=\"nameError\"\r\n                />\r\n                {validationErrors.name && (\r\n                  <div id=\"nameError\" className=\"invalid-feedback\">\r\n                    {validationErrors.name}\r\n                  </div>\r\n                )}\r\n              </div>\r\n              {/* Email */}\r\n              <div className=\"mb-3\">\r\n                <label htmlFor=\"editEmail\" className=\"form-label\">\r\n                  Email cím\r\n                </label>\r\n                <input\r\n                  type=\"email\"\r\n                  className={`form-control ${\r\n                    validationErrors.email ? \"is-invalid\" : \"\"\r\n                  }`}\r\n                  id=\"editEmail\"\r\n                  value={newEmail}\r\n                  onChange={(e) => setNewEmail(e.target.value)}\r\n                  required\r\n                  disabled={updateLoading}\r\n                  aria-describedby=\"emailError\"\r\n                />\r\n                {validationErrors.email && (\r\n                  <div id=\"emailError\" className=\"invalid-feedback\">\r\n                    {validationErrors.email}\r\n                  </div>\r\n                )}\r\n              </div>\r\n              {/* Phone */}\r\n              <div className=\"mb-3\">\r\n                <label htmlFor=\"editPhoneNumber\" className=\"form-label\">\r\n                  Telefonszám (opcionális)\r\n                </label>\r\n                <input\r\n                  type=\"tel\"\r\n                  className={`form-control ${\r\n                    validationErrors.phoneNumber ? \"is-invalid\" : \"\"\r\n                  }`}\r\n                  id=\"editPhoneNumber\"\r\n                  value={phoneNumber}\r\n                  onChange={(e) => setPhoneNumber(e.target.value)}\r\n                  placeholder=\"Pl. +36 30 123 4567\"\r\n                  disabled={updateLoading}\r\n                  aria-describedby=\"phoneNumberError\"\r\n                />\r\n                {validationErrors.phoneNumber && (\r\n                  <div id=\"phoneNumberError\" className=\"invalid-feedback\">\r\n                    {validationErrors.phoneNumber}\r\n                  </div>\r\n                )}\r\n              </div>\r\n              {/* Password */}\r\n              <div className=\"mb-3\">\r\n                <label htmlFor=\"editPassword\" className=\"form-label\">\r\n                  Új jelszó (üresen hagyva nem változik)\r\n                </label>\r\n                <input\r\n                  type=\"password\"\r\n                  className={`form-control ${\r\n                    validationErrors.password ? \"is-invalid\" : \"\"\r\n                  }`}\r\n                  id=\"editPassword\"\r\n                  value={newPassword}\r\n                  onChange={(e) => setNewPassword(e.target.value)}\r\n                  placeholder=\"Min. 6 karakter\"\r\n                  disabled={updateLoading}\r\n                  aria-describedby=\"passwordError\"\r\n                />\r\n                {validationErrors.password && (\r\n                  <div id=\"passwordError\" className=\"invalid-feedback\">\r\n                    {validationErrors.password}\r\n                  </div>\r\n                )}\r\n              </div>\r\n              {/* Action Buttons */}\r\n              <div className=\"profile-actions mt-4\">\r\n                <button\r\n                  type=\"submit\"\r\n                  className=\"btn btn-primary\"\r\n                  disabled={updateLoading}\r\n                >\r\n                  {updateLoading ? (\r\n                    <>\r\n                      <span\r\n                        className=\"spinner-border spinner-border-sm me-2\"\r\n                        role=\"status\"\r\n                        aria-hidden=\"true\"\r\n                      ></span>\r\n                      Mentés...\r\n                    </>\r\n                  ) : (\r\n                    \"Mentés\"\r\n                  )}\r\n                </button>\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"btn btn-outline-secondary ms-2\"\r\n                  onClick={handleCancelEdit}\r\n                  disabled={updateLoading}\r\n                >\r\n                  Mégse\r\n                </button>\r\n              </div>\r\n            </form>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Profile;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}